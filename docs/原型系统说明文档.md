# 央企穿透式监督知识图谱原型系统

## 一、系统概述

基于 Nebula Graph 图数据库构建央企穿透式监督知识图谱，使用Mock数据测试两类业务场景：

1. **循环交易监测**：检测企业间的循环交易模式
2. **法律风险传导**：追踪法律事件对企业及其关联方的影响

---

## 二、知识图谱设计

### 2.1 节点类型

#### Person（人员节点）
| 属性 | 说明 | 示例 |
|------|------|------|
| node_id | 节点ID | USER_001 |
| name | 姓名 | 张伟 |
| number | 工号 | EMP0001 |
| id_card | 证件号码 | 310101199001011234 |
| gender | 性别 | 1:男 2:女 |
| birthday | 出生日期 | 1990-01-01 |
| status | 状态 | C:已审核 |

#### Company（公司节点）
| 属性 | 说明 | 示例 |
|------|------|------|
| node_id | 节点ID | ORG_001 |
| name | 公司名称 | 中央建设集团有限公司 |
| company_type | 公司类型 | Organization/Supplier/Customer/Counterpart |
| legal_person | 法人代表 | 张伟 |
| credit_code | 社会信用代码 | 91110000MA001234XX |
| establish_date | 成立日期 | 2010-05-20 |
| status | 状态 | C:已审核 |

#### Contract（合同节点）
| 属性 | 说明 | 示例 |
|------|------|------|
| node_id | 节点ID | CON_001 |
| contract_no | 合同编号 | HT2024000001 |
| contract_name | 合同名称 | 建材采购合同-华信建材有限公司 |
| amount | 签约金额 | 5000000.00 |
| sign_date | 签订日期 | 2024-06-15 |
| status | 状态 | EXECUTING:执行中 COMPLETED:已完成 |

#### LegalEvent（法律事件节点）
| 属性 | 说明 | 示例 |
|------|------|------|
| node_id | 节点ID | CASE_001 |
| event_type | 事件类型 | Case:案件 Dispute:纠纷 |
| event_name | 事件名称 | 合同纠纷案件-1 |
| amount | 涉及金额 | 1500000.00 |
| status | 状态 | F:已立案 I:一审 N:已结案 J:执行 |
| register_date | 登记日期 | 2024-03-15 |

### 2.2 边类型

| 边类型 | 方向 | 说明 | 数量 |
|--------|------|------|------|
| LEGAL_PERSON | Person → Company | 法人代表关系 | 90 |
| CONTROLS | Company → Company | 控股关系 | 15 |
| PARTY_A/B/C/D | Company → Contract | 合同签署关系（甲乙丙丁方） | 200 |
| TRADES_WITH | Company → Company | 交易关系 | 100 |
| INVOLVED_IN | Person → LegalEvent | 人员涉及法律事件 | 10 |
| RELATED_TO | Contract → LegalEvent | 合同关联法律事件 | 20 |

### 2.3 控股结构示例

```
中央建设集团有限公司 (ORG_001)
  ├─ 中建华东分公司
  ├─ 中建华南分公司
  └─ 中建西部分公司

中国石油天然气集团 (ORG_005)
  ├─ 中石油华东销售公司
  ├─ 中石油华南销售公司
  └─ 中国铁路工程集团
```

---

## 三、Mock数据设计

### 3.1 数据来源

| 数据表 | 节点/边类型 | 数量 |
|--------|-------------|------|
| t_sec_user | Person | 80 |
| t_org_org | Company (Organization) | 25 |
| t_bd_supplier | Company (Supplier) | 30 |
| t_bd_customer | Company (Customer) | 20 |
| t_mscon_counterpart | Company (Counterpart) | 15 |
| t_mscon_contract | Contract | 100 |
| t_conl_case | LegalEvent (Case) | 10 |
| t_conl_disputeregist | LegalEvent (Dispute) | 10 |

### 3.2 场景数据设计

#### 场景一：循环交易

设计了一个三方循环交易，金额高度相似：

| 交易方向 | 金额（元） |
|----------|-----------|
| 华润置地发展 → 国家电网集团公司 | 9,994,149.00 |
| 国家电网集团公司 → 中天建筑材料 | 9,919,290.00 |
| 中天建筑材料 → 华润置地发展 | 9,902,595.00 |

**金额相似度**：99.60%（基于变异系数计算）

#### 场景二：法律风险传导

设计了一条多层级风险传导路径：

```
人员: 胡芳 (USER_009)
  ↓ [LEGAL_PERSON]
母公司: 中国石油天然气集团
  ↓ [CONTROLS]
子公司: 中石油华东销售公司、中石油华南销售公司、中国铁路工程集团（3家）
  ↓ [PARTY_A]
合同: 10份合作合同
  ↓ [PARTY_B]
交易对手: 14家公司

法律事件: 债权债务案件-9（状态：F-已立案）
```

---

## 四、执行效果验证

### 4.1 循环交易监测

**检测结果**：

```
============================================================
循环交易监测 Demo
============================================================
✓ 成功连接到 Nebula Graph
正在检测循环交易模式...
检测到 3 个可疑的循环交易模式:

[1]
循环交易检测到闭环:
起始公司: 华润置地发展
交易路径: 华润置地发展 -> 华润置地发展 -> 国家电网集团公司 -> 中天建筑材料 -> 华润置地发展
交易金额: 9,994,149.00, 9,919,290.00, 9,902,595.00
金额相似度: 99.60%
循环长度: 3 个节点
⚠️  预警: 金额相似度超过90%，疑似循环交易！

[2]
循环交易检测到闭环:
起始公司: 国家电网集团公司
交易路径: 国家电网集团公司 -> 国家电网集团公司 -> 中天建筑材料 -> 华润置地发展 -> 国家电网集团公司
交易金额: 9,919,290.00, 9,902,595.00, 9,994,149.00
金额相似度: 99.60%
循环长度: 3 个节点
⚠️  预警: 金额相似度超过90%，疑似循环交易！

[3]
循环交易检测到闭环:
起始公司: 中天建筑材料
交易路径: 中天建筑材料 -> 中天建筑材料 -> 华润置地发展 -> 国家电网集团公司 -> 中天建筑材料
交易金额: 9,902,595.00, 9,994,149.00, 9,919,290.00
金额相似度: 99.60%
循环长度: 3 个节点
⚠️  预警: 金额相似度超过90%，疑似循环交易！
```

**检测算法**：
- 图遍历算法：深度优先搜索（DFS）
- 相似度计算：基于变异系数（CV = 标准差 / 平均值，相似度 = (1 - CV) × 100%）
- 预警阈值：相似度 ≥ 90%

**结果说明**：
- 检测到3条循环路径（同一循环的不同起点）
- 每条路径均正确显示公司名称、交易金额
- 金额相似度计算准确（99.60%）
- 触发预警逻辑正常

---

### 4.2 法律风险传导监测

**检测结果示例一**：

```
============================================================
法律事件监测 Demo
============================================================
✓ 成功连接到 Nebula Graph
正在查找涉及法律事件的人员...
找到 10 个涉及法律事件的人员

正在分析: 胡芳 (债权债务案件-9)...
  该人员担任 1 家公司的法人代表

============================================================
风险传导监测报告
============================================================
涉及人员: 胡芳 (USER_009)
法律事件: 债权债务案件-9 (Case)
事件状态: F

发现 11 条风险传导路径:

[路径 1]
USER_009 --[LEGAL_PERSON]--> 中国石油天然气集团 --[CONTROLS]--> 中国石油天然气集团 --[PARTY]--> 中国石油天然气集团与工程测绘服务合作合同 --[PARTY]--> 工程测绘服务

[路径 2]
USER_009 --[LEGAL_PERSON]--> 中国石油天然气集团 --[CONTROLS]--> 中国石油天然气集团 --[PARTY]--> 中国石油天然气集团与环境影响评价合作合同 --[PARTY]--> 环境影响评价

[路径 3]
USER_009 --[LEGAL_PERSON]--> 中国石油天然气集团 --[CONTROLS]--> 中国石油天然气集团 --[PARTY]--> 中国石油天然气集团与恒大地产集团合作合同 --[PARTY]--> 恒大地产集团

[路径 4]
USER_009 --[LEGAL_PERSON]--> 中国石油天然气集团 --[CONTROLS]--> 中石油华东销售公司 --[PARTY]--> 中石油华东销售公司与建筑法律咨询合作合同 --[PARTY]--> 建筑法律咨询

[路径 5]
USER_009 --[LEGAL_PERSON]--> 中国石油天然气集团 --[CONTROLS]--> 中石油华南销售公司 --[PARTY]--> 中石油华南销售公司与工程保险代理合作合同 --[PARTY]--> 工程保险代理

[路径 6]
USER_009 --[LEGAL_PERSON]--> 中国石油天然气集团 --[CONTROLS]--> 中石油华南销售公司 --[PARTY]--> 中石油华南销售公司与中建设计研究院合作合同 --[PARTY]--> 中建设计研究院

[路径 7]
USER_009 --[LEGAL_PERSON]--> 中国石油天然气集团 --[CONTROLS]--> 中石油华南销售公司 --[PARTY]--> 中石油华南销售公司与博达工程机械合作合同 --[PARTY]--> 博达工程机械

[路径 8]
USER_009 --[LEGAL_PERSON]--> 中国石油天然气集团 --[CONTROLS]--> 中国铁路工程集团 --[PARTY]--> 中国铁路工程集团与荣盛发展合作合同 --[PARTY]--> 荣盛发展

[路径 9]
USER_009 --[LEGAL_PERSON]--> 中国石油天然气集团 --[CONTROLS]--> 中国铁路工程集团 --[PARTY]--> 中国铁路工程集团与建筑安全评估合作合同 --[PARTY]--> 建筑安全评估

[路径 10]
USER_009 --[LEGAL_PERSON]--> 中国石油天然气集团 --[CONTROLS]--> 中国铁路工程集团 --[PARTY]--> 中国铁路工程集团与瑞祥机电设备合作合同 --[PARTY]--> 瑞祥机电设备

[路径 11]
USER_009 --[LEGAL_PERSON]--> 中国石油天然气集团 --[CONTROLS]--> 中国铁路工程集团 --[PARTY]--> 中国铁路工程集团与建筑法律咨询合作合同 --[PARTY]--> 建筑法律咨询

风险影响范围:
- 受影响公司数量: 14
- 受影响合同数量: 10

受影响公司列表:
  - 建筑法律咨询
  - 环境影响评价
  - 中国石油天然气集团
  - 恒大地产集团
  - 中国铁路工程集团
  - 博达工程机械
  - 工程保险代理
  - 建筑安全评估
  - 中石油华东销售公司
  - 中石油华南销售公司
  - 工程测绘服务
  - 中建设计研究院
  - 荣盛发展
  - 瑞祥机电设备

受影响合同列表:
  - 中国石油天然气集团与环境影响评价合作合同
  - 中石油华东销售公司与建筑法律咨询合作合同
  - 中国铁路工程集团与荣盛发展合作合同
  - 中国铁路工程集团与瑞祥机电设备合作合同
  - 中国石油天然气集团与工程测绘服务合作合同
  - 中国铁路工程集团与建筑安全评估合作合同
  - 中石油华南销售公司与中建设计研究院合作合同
  - 中石油华南销售公司与博达工程机械合作合同
  - 中国石油天然气集团与恒大地产集团合作合同
  - 中石油华南销售公司与工程保险代理合作合同

⚠️  风险预警: 建议对上述公司和合同进行风险评估！
```

**检测结果示例二**：

```
正在分析: 赵伟 (债权债务案件-4)...
  该人员担任 1 家公司的法人代表

============================================================
风险传导监测报告
============================================================
涉及人员: 赵伟 (USER_004)
法律事件: 债权债务案件-4 (Case)
事件状态: J

发现 1 条风险传导路径:

[路径 1]
USER_004 --[LEGAL_PERSON]--> 中建西部分公司 --[CONTROLS]--> 中建西部分公司 --[PARTY]--> 中建西部分公司与建筑安全评估合作合同 --[PARTY]--> 建筑安全评估

风险影响范围:
- 受影响公司数量: 2
- 受影响合同数量: 1

受影响公司列表:
  - 中建西部分公司
  - 建筑安全评估

受影响合同列表:
  - 中建西部分公司与建筑安全评估合作合同

⚠️  风险预警: 建议对上述公司和合同进行风险评估！
```

**检测结果示例三**：

```
正在分析: 朱秀兰 (合同纠纷案件-1)...
  该人员担任 1 家公司的法人代表

============================================================
风险传导监测报告
============================================================
涉及人员: 朱秀兰 (USER_001)
法律事件: 合同纠纷案件-1 (Case)
事件状态: N

发现 20 条风险传导路径:

[路径 1]
USER_001 --[LEGAL_PERSON]--> 中央建设集团有限公司 --[CONTROLS]--> 中央建设集团有限公司 --[PARTY]--> 中央建设集团有限公司与恒大地产集团合作合同 --[PARTY]--> 恒大地产集团

[路径 2]
USER_001 --[LEGAL_PERSON]--> 中央建设集团有限公司 --[CONTROLS]--> 中央建设集团有限公司 --[PARTY]--> 中央建设集团有限公司与博瑞工程设备合作合同 --[PARTY]--> 博瑞工程设备

[路径 3]
USER_001 --[LEGAL_PERSON]--> 中央建设集团有限公司 --[CONTROLS]--> 中央建设集团有限公司 --[PARTY]--> 中央建设集团有限公司与中建设计研究院合作合同 --[PARTY]--> 中建设计研究院

[路径 4]
USER_001 --[LEGAL_PERSON]--> 中央建设集团有限公司 --[CONTROLS]--> 中央建设集团有限公司 --[PARTY]--> 中央建设集团有限公司与东方钢铁集团合作合同 --[PARTY]--> 东方钢铁集团

[路径 5]
USER_001 --[LEGAL_PERSON]--> 中央建设集团有限公司 --[CONTROLS]--> 中央建设集团有限公司 --[PARTY]--> 中央建设集团有限公司与工程保险代理合作合同 --[PARTY]--> 工程保险代理

[路径 6]
USER_001 --[LEGAL_PERSON]--> 中央建设集团有限公司 --[CONTROLS]--> 中建华东分公司 --[PARTY]--> 中建华东分公司与腾飞机械设备合作合同 --[PARTY]--> 腾飞机械设备

[路径 7]
USER_001 --[LEGAL_PERSON]--> 中央建设集团有限公司 --[CONTROLS]--> 中建华东分公司 --[PARTY]--> 建材采购合同-永盛钢构工程 --[PARTY]--> 永盛钢构工程

[路径 8]
USER_001 --[LEGAL_PERSON]--> 中央建设集团有限公司 --[CONTROLS]--> 中建华东分公司 --[PARTY]--> 中建华东分公司与工程测绘服务合作合同 --[PARTY]--> 工程测绘服务

[路径 9]
USER_001 --[LEGAL_PERSON]--> 中央建设集团有限公司 --[CONTROLS]--> 中建华东分公司 --[PARTY]--> 建材采购合同-天成电气设备 --[PARTY]--> 天成电气设备

[路径 10]
USER_001 --[LEGAL_PERSON]--> 中央建设集团有限公司 --[CONTROLS]--> 中建华东分公司 --[PARTY]--> 建材采购合同-金石建材供应 --[PARTY]--> 金石建材供应

... (省略10条路径)

风险影响范围:
- 受影响公司数量: 12
- 受影响合同数量: 10

受影响公司列表:
  - 金石建材供应
  - 恒大地产集团
  - 中建华东分公司
  - 东方钢铁集团
  - 中央建设集团有限公司
  - 工程保险代理
  - 腾飞机械设备
  - 天成电气设备
  - 博瑞工程设备
  - 中建设计研究院
  - 工程测绘服务
  - 永盛钢构工程

受影响合同列表:
  - 中建华东分公司与工程测绘服务合作合同
  - 建材采购合同-天成电气设备
  - 中央建设集团有限公司与博瑞工程设备合作合同
  - 中央建设集团有限公司与中建设计研究院合作合同
  - 建材采购合同-金石建材供应
  - 中央建设集团有限公司与东方钢铁集团合作合同
  - 建材采购合同-永盛钢构工程
  - 中央建设集团有限公司与工程保险代理合作合同
  - 中央建设集团有限公司与恒大地产集团合作合同
  - 中建华东分公司与腾飞机械设备合作合同

⚠️  风险预警: 建议对上述公司和合同进行风险评估！
```

**检测算法**：
- 路径追踪：Person → LegalEvent → Company → Contract → Company
- 关系扩展：通过 CONTROLS 关系从母公司扩展到子公司
- 影响范围统计：去重后统计受影响的公司和合同数量

**结果说明**：
- 共检测10个涉及法律事件的人员
- 不同人员的影响范围差异明显：
  - 胡芳（大型集团法人）：11条路径，影响14家公司、10份合同
  - 朱秀兰（大型集团法人）：20条路径，影响12家公司、10份合同
  - 赵伟（分公司法人）：1条路径，影响2家公司、1份合同
- 所有路径均正确显示节点名称和关系类型

---

**文档版本**：v1.0  
**更新日期**：2025-11-14
